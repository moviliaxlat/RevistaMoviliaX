import React, { useState } from 'react';
import { 
  BarChart, Bar, LineChart, Line, PieChart, Pie, Cell, 
  XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer 
} from 'recharts';

const EVInfographic = () => {
  const [activeTab, setActiveTab] = useState('ventas');

  // Datos
  const ventasData = [
    { a√±o: '2019', vehiculos: 12000 },
    { a√±o: '2020', vehiculos: 28000 },
    { a√±o: '2021', vehiculos: 95000 },
    { a√±o: '2022', vehiculos: 245000 },
    { a√±o: '2023', vehiculos: 485000 },
    { a√±o: '2024', vehiculos: 890000 }
  ];

  const infraData = [
    { a√±o: '2020', cargadores: 320 },
    { a√±o: '2021', cargadores: 780 },
    { a√±o: '2022', cargadores: 1450 },
    { a√±o: '2023', cargadores: 2300 },
    { a√±o: '2024', cargadores: 3200 }
  ];

  const tipoData = [
    { name: 'H√≠bridos', value: 52, color: '#6B46FF' },
    { name: 'El√©ctricos Puros', value: 35, color: '#00E0FF' },
    { name: 'H√≠bridos Enchufables', value: 13, color: '#7A7F8C' }
  ];

  const ciudadesData = [
    { ciudad: 'CDMX', vehiculos: 285000 },
    { ciudad: 'Monterrey', vehiculos: 145000 },
    { ciudad: 'Guadalajara', vehiculos: 98000 },
    { ciudad: 'Quer√©taro', vehiculos: 67000 },
    { ciudad: 'Puebla', vehiculos: 52000 }
  ];

  const proyeccionData = [
    { a√±o: '2024', vehiculos: 890 },
    { a√±o: '2025', vehiculos: 1250 },
    { a√±o: '2026', vehiculos: 1580 },
    { a√±o: '2027', vehiculos: 1850 },
    { a√±o: '2028', vehiculos: 2100 },
    { a√±o: '2029', vehiculos: 2300 },
    { a√±o: '2030', vehiculos: 2500 }
  ];

  const stats = [
    { label: 'Veh√≠culos EV', value: '890K', icon: 'üöó', change: '+127%' },
    { label: 'Puntos de Carga', value: '3,200+', icon: '‚ö°', change: '+39%' },
    { label: 'Inversi√≥n 2024', value: '$4.2B', icon: 'üí∞', change: '+85%' },
    { label: 'Ahorro Promedio', value: '40%', icon: 'üìä', change: 'vs combusti√≥n' }
  ];

  // Formatter para tooltips
  const formatNumber = (value) => {
    return value.toLocaleString('es-MX');
  };

  // Estilos CSS (en un proyecto real, estos ir√≠an en un archivo CSS separado)
  const styles = {
    container: {
      fontFamily: "'Inter', sans-serif",
      background: 'linear-gradient(135deg, #0A0F2C 0%, #1a1f4a 100%)',
      minHeight: '100vh',
      padding: '40px 20px',
      color: '#ffffff'
    },
    maxWidth: {
      maxWidth: '1200px',
      margin: '0 auto',
      marginBottom: '50px'
    },
    header: {
      textAlign: 'center',
      marginBottom: '20px'
    },
    title: {
      fontSize: '48px',
      fontWeight: '900',
      margin: '0 0 15px 0',
      background: 'linear-gradient(135deg, #ffffff, #00E0FF)',
      WebkitBackgroundClip: 'text',
      WebkitTextFillColor: 'transparent',
      backgroundClip: 'text',
      letterSpacing: '2px'
    },
    subtitle: {
      fontSize: '20px',
      color: '#7A7F8C',
      margin: 0
    },
    statsGrid: {
      display: 'grid',
      gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))',
      gap: '20px',
      marginBottom: '50px'
    },
    tabsContainer: {
      display: 'flex',
      gap: '10px',
      justifyContent: 'center',
      marginBottom: '40px',
      flexWrap: 'wrap'
    },
    chartContainer: {
      background: 'rgba(255, 255, 255, 0.03)',
      border: '1px solid rgba(0, 224, 255, 0.2)',
      borderRadius: '20px',
      padding: '40px',
      marginBottom: '40px'
    },
    chartTitle: {
      fontSize: '28px',
      fontWeight: '800',
      color: '#00E0FF',
      marginBottom: '30px',
      textAlign: 'center'
    },
    chartSubtext: {
      textAlign: 'center',
      color: '#7A7F8C',
      marginTop: '20px',
      fontSize: '14px'
    },
    insightsGrid: {
      display: 'grid',
      gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))',
      gap: '20px',
      marginBottom: '40px'
    },
    footer: {
      textAlign: 'center',
      padding: '40px 20px',
      background: 'rgba(0, 224, 255, 0.05)',
      borderRadius: '20px',
      border: '1px solid rgba(0, 224, 255, 0.2)'
    }
  };

  // Custom Tooltip con formato
  const CustomTooltip = ({ active, payload, label }) => {
    if (active && payload && payload.length) {
      return (
        <div style={{
          background: '#0A0F2C',
          border: '1px solid #00E0FF',
          borderRadius: '10px',
          padding: '10px',
          color: '#ffffff'
        }}>
          <p style={{ margin: '0 0 5px 0' }}>{label}</p>
          <p style={{ margin: 0, color: '#00E0FF', fontWeight: 'bold' }}>
            {formatNumber(payload[0].value)}
          </p>
        </div>
      );
    }
    return null;
  };

  // Componente StatCard
  const StatCard = ({ stat }) => (
    <div 
      className="stat-card"
      style={{
        background: 'rgba(0, 224, 255, 0.05)',
        border: '1px solid rgba(0, 224, 255, 0.2)',
        borderRadius: '15px',
        padding: '30px',
        textAlign: 'center',
        transition: 'all 0.3s',
        cursor: 'pointer'
      }}
    >
      <div style={{ fontSize: '48px', marginBottom: '10px' }}>{stat.icon}</div>
      <div style={{
        fontSize: '36px',
        fontWeight: '900',
        color: '#00E0FF',
        marginBottom: '5px'
      }}>
        {stat.value}
      </div>
      <div style={{
        fontSize: '14px',
        color: '#7A7F8C',
        textTransform: 'uppercase',
        letterSpacing: '1px',
        marginBottom: '10px'
      }}>
        {stat.label}
      </div>
      <div style={{
        display: 'inline-block',
        padding: '5px 15px',
        background: 'rgba(0, 224, 255, 0.2)',
        borderRadius: '20px',
        fontSize: '12px',
        color: '#00E0FF',
        fontWeight: '600'
      }}>
        {stat.change}
      </div>
    </div>
  );

  // Componente TabButton
  const TabButton = ({ id, label, isActive, onClick }) => (
    <button
      onClick={onClick}
      aria-pressed={isActive}
      aria-label={`Ver gr√°fica de ${label}`}
      style={{
        padding: '15px 30px',
        background: isActive 
          ? 'linear-gradient(135deg, #00E0FF, #0099cc)' 
          : 'rgba(255, 255, 255, 0.05)',
        color: isActive ? '#0A0F2C' : '#ffffff',
        border: isActive ? 'none' : '1px solid rgba(0, 224, 255, 0.3)',
        borderRadius: '25px',
        fontSize: '14px',
        fontWeight: '700',
        cursor: 'pointer',
        transition: 'all 0.3s',
        textTransform: 'uppercase',
        letterSpacing: '1px'
      }}
    >
      {label}
    </button>
  );

  // Componente InsightCard
  const InsightCard = ({ color, icon, title, text }) => (
    <div style={{
      background: `rgba(${color}, 0.05)`,
      border: `1px solid rgba(${color}, 0.2)`,
      borderLeft: `4px solid rgb(${color})`,
      borderRadius: '10px',
      padding: '25px'
    }}>
      <h3 style={{
        fontSize: '20px',
        fontWeight: '700',
        color: `rgb(${color})`,
        marginBottom: '15px'
      }}>
        {icon} {title}
      </h3>
      <p style={{ color: '#ffffff', lineHeight: '1.7', margin: 0 }}>
        {text}
      </p>
    </div>
  );

  return (
    <div style={styles.container}>
      <div style={styles.maxWidth}>
        {/* Header */}
        <div style={styles.header}>
          <h1 style={styles.title}>
            El Boom de los EVs en M√©xico
          </h1>
          <p style={styles.subtitle}>
            Datos actualizados a Octubre 2024
          </p>
        </div>

        {/* Stats Grid */}
        <div style={styles.statsGrid}>
          {stats.map((stat, i) => (
            <StatCard key={`stat-${i}`} stat={stat} />
          ))}
        </div>

        {/* Tabs */}
        <div style={styles.tabsContainer}>
          <TabButton 
            id="ventas" 
            label="Evoluci√≥n Ventas" 
            isActive={activeTab === 'ventas'}
            onClick={() => setActiveTab('ventas')}
          />
          <TabButton 
            id="infra" 
            label="Infraestructura" 
            isActive={activeTab === 'infra'}
            onClick={() => setActiveTab('infra')}
          />
          <TabButton 
            id="tipo" 
            label="Por Tipo" 
            isActive={activeTab === 'tipo'}
            onClick={() => setActiveTab('tipo')}
          />
          <TabButton 
            id="ciudades" 
            label="Por Ciudad" 
            isActive={activeTab === 'ciudades'}
            onClick={() => setActiveTab('ciudades')}
          />
          <TabButton 
            id="proyeccion" 
            label="Proyecci√≥n 2030" 
            isActive={activeTab === 'proyeccion'}
            onClick={() => setActiveTab('proyeccion')}
          />
        </div>

        {/* Charts */}
        <div style={styles.chartContainer}>
          {activeTab === 'ventas' && (
            <div>
              <h2 style={styles.chartTitle}>
                Evoluci√≥n de Ventas de Veh√≠culos El√©ctricos e H√≠bridos
              </h2>
              <ResponsiveContainer width="100%" height={400}>
                <BarChart data={ventasData}>
                  <CartesianGrid strokeDasharray="3 3" stroke="rgba(0, 224, 255, 0.1)" />
                  <XAxis dataKey="a√±o" stroke="#7A7F8C" />
                  <YAxis stroke="#7A7F8C" tickFormatter={formatNumber} />
                  <Tooltip content={<CustomTooltip />} />
                  <Bar dataKey="vehiculos" fill="#00E0FF" radius={[10, 10, 0, 0]} />
                </BarChart>
              </ResponsiveContainer>
              <p style={styles.chartSubtext}>
                Crecimiento exponencial de 7,417% en 5 a√±os
              </p>
            </div>
          )}

          {activeTab === 'infra' && (
            <div>
              <h2 style={styles.chartTitle}>
                Expansi√≥n de Puntos de Carga P√∫blicos
              </h2>
              <ResponsiveContainer width="100%" height={400}>
                <LineChart data={infraData}>
                  <CartesianGrid strokeDasharray="3 3" stroke="rgba(0, 224, 255, 0.1)" />
                  <XAxis dataKey="a√±o" stroke="#7A7F8C" />
                  <YAxis stroke="#7A7F8C" tickFormatter={formatNumber} />
                  <Tooltip content={<CustomTooltip />} />
                  <Line 
                    type="monotone" 
                    dataKey="cargadores" 
                    stroke="#00E0FF" 
                    strokeWidth={3}
                    dot={{ fill: '#00E0FF', r: 6 }}
                  />
                </LineChart>
              </ResponsiveContainer>
              <p style={styles.chartSubtext}>
                Crecimiento promedio de 80 nuevas estaciones mensuales en 2024
              </p>
            </div>
          )}

          {activeTab === 'tipo' && (
            <div>
              <h2 style={styles.chartTitle}>
                Distribuci√≥n por Tipo de Veh√≠culo
              </h2>
              <ResponsiveContainer width="100%" height={400}>
                <PieChart>
                  <Pie
                    data={tipoData}
                    cx="50%"
                    cy="50%"
                    labelLine={false}
                    label={({ name, value }) => `${name}: ${value}%`}
                    outerRadius={120}
                    dataKey="value"
                  >
                    {tipoData.map((entry, index) => (
                      <Cell key={`cell-${index}`} fill={entry.color} />
                    ))}
                  </Pie>
                  <Tooltip content={<CustomTooltip />} />
                </PieChart>
              </ResponsiveContainer>
              <div style={{
                display: 'flex',
                justifyContent: 'center',
                gap: '30px',
                marginTop: '30px',
                flexWrap: 'wrap'
              }}>
                {tipoData.map((tipo, i) => (
                  <div key={`legend-${i}`} style={{ textAlign: 'center' }}>
                    <div style={{
                      width: '20px',
                      height: '20px',
                      background: tipo.color,
                      margin: '0 auto 10px',
                      borderRadius: '5px'
                    }} />
                    <div style={{ fontSize: '14px', color: '#7A7F8C' }}>{tipo.name}</div>
                  </div>
                ))}
              </div>
            </div>
          )}

          {activeTab === 'ciudades' && (
            <div>
              <h2 style={styles.chartTitle}>
                Top 5 Ciudades con M√°s Veh√≠culos El√©ctricos
              </h2>
              <ResponsiveContainer width="100%" height={400}>
                <BarChart data={ciudadesData} layout="vertical">
                  <CartesianGrid strokeDasharray="3 3" stroke="rgba(0, 224, 255, 0.1)" />
                  <XAxis type="number" stroke="#7A7F8C" tickFormatter={formatNumber} />
                  <YAxis dataKey="ciudad" type="category" stroke="#7A7F8C" />
                  <Tooltip content={<CustomTooltip />} />
                  <Bar dataKey="vehiculos" fill="#6B46FF" radius={[0, 10, 10, 0]} />
                </BarChart>
              </ResponsiveContainer>
              <p style={styles.chartSubtext}>
                Estas 5 ciudades concentran el 72% del total de EVs en M√©xico
              </p>
            </div>
          )}

          {activeTab === 'proyeccion' && (
            <div>
              <h2 style={styles.chartTitle}>
                Proyecci√≥n de Ventas 2024-2030 (miles de unidades)
              </h2>
              <ResponsiveContainer width="100%" height={400}>
                <LineChart data={proyeccionData}>
                  <CartesianGrid strokeDasharray="3 3" stroke="rgba(0, 224, 255, 0.1)" />
                  <XAxis dataKey="a√±o" stroke="#7A7F8C" />
                  <YAxis stroke="#7A7F8C" tickFormatter={formatNumber} />
                  <Tooltip content={<CustomTooltip />} />
                  <Line 
                    type="monotone" 
                    dataKey="vehiculos" 
                    stroke="#00E0FF" 
                    strokeWidth={4}
                    strokeDasharray="5 5"
                    dot={{ fill: '#00E0FF', r: 8 }}
                  />
                </LineChart>
              </ResponsiveContainer>
              <div style={{
                textAlign: 'center',
                marginTop: '30px',
                padding: '20px',
                background: 'rgba(0, 224, 255, 0.1)',
                borderRadius: '10px'
              }}>
                <div style={{
                  fontSize: '48px',
                  fontWeight: '900',
                  color: '#00E0FF',
                  marginBottom: '10px'
                }}>
                  2.5M+
                </div>
                <div style={{ fontSize: '16px', color: '#7A7F8C' }}>
                  Veh√≠culos el√©ctricos proyectados para 2030
                </div>
              </div>
            </div>
          )}
        </div>

        {/* Key Insights */}
        <div style={styles.insightsGrid}>
          <InsightCard
            color="0, 224, 255"
            icon="üí°"
            title="Dato Clave"
            text="M√©xico es el 2¬∫ mercado de EVs m√°s grande de Am√©rica Latina, superado solo por Brasil. El crecimiento de 127% en 2024 es el m√°s alto de la regi√≥n."
          />
          <InsightCard
            color="107, 70, 255"
            icon="üéØ"
            title="Oportunidad"
            text="El mercado de log√≠stica el√©ctrica est√° creciendo 3x m√°s r√°pido que el de veh√≠culos particulares. Amazon, Mercado Libre y DHL est√°n electrificando flotas completas."
          />
          <InsightCard
            color="255, 193, 7"
            icon="‚ö†Ô∏è"
            title="Desaf√≠o"
            text="La infraestructura de carga est√° concentrada en 3 ciudades. Se necesitan 45,000+ puntos adicionales para alcanzar la meta de 2030."
          />
        </div>

        {/* Footer */}
        <div style={styles.footer}>
          <div style={{
            fontSize: '32px',
            fontWeight: '900',
            marginBottom: '15px'
          }}>
            MOVILIA<span style={{ color: '#00E0FF' }}>X</span>
          </div>
          <p style={{
            color: '#7A7F8C',
            fontSize: '14px',
            marginBottom: '20px'
          }}>
            Movilidad y Log√≠stica Digital en M√©xico
          </p>
          <div style={{
            display: 'flex',
            gap: '15px',
            justifyContent: 'center',
            flexWrap: 'wrap',
            fontSize: '12px',
            color: '#7A7F8C'
          }}>
            <span>üìä Fuentes: AMIA, INEGI, Bloomberg NEF</span>
            <span>‚Ä¢</span>
            <span>üìÖ Actualizado: Octubre 2024</span>
            <span>‚Ä¢</span>
            <span>üìß moviliax.com</span>
          </div>
        </div>
      </div>
    </div>
  );
};

export default EVInfographic;
